(function(e){e.fn.enableCellNavigation=function(){var t={left:37,up:38,right:39,down:40};this.find("input").keydown(function(n){if(e.inArray(n.which,[t.left,t.up,t.right,t.down])<0){return}var r=n.target;var i=e(n.target).closest("td");var s=null;switch(n.which){case t.left:{if(r.selectionStart==0){s=i.prev("td:has(input,textarea)")}break};case t.right:{if(r.selectionEnd==r.value.length){s=i.next("td:has(input,textarea)")}break};case t.up:case t.down:{var o=i.closest("tr");var u=i[0].cellIndex;var a=null;if(n.which==t.down){a=o.next("tr")}else if(n.which==t.up){a=o.prev("tr")}if(a.length){s=e(a[0].cells[u])}break}}if(s&&s.length){n.preventDefault();s.find("input,textarea").each(function(e,t){if(!$(t).closest("tr").hasClass("retirado")){t.focus();t.select()}else{var r=$(t).parents("form:eq(0),body").find("input").not("input:disabled");var i=$(t).closest("tr").find("input:enabled").size();var s=$(t).closest("tr").next("tr");var o=r.index(t);switch(n.which){case 40:for(var u=o;u+Number(i)<r.length;){if(u+Number(i)<r.length){if(!$(r.eq(u+i)).closest("tr").hasClass("retirado")){$(r.eq(u+i)).focus();break}}u=u+Number(i)}break;case 38:for(var u=o;u-Number(i)>0;){if(u-Number(i)>0){if(!$(r.eq(u-i)).closest("tr").hasClass("retirado")){$(r.eq(u-i)).focus();break}}u=u-Number(i)}break}}})}})}})(jQuery)
